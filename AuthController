package com.example.jwtmock.controller;

import com.example.jwtmock.service.JwtMockService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.HashMap;
import java.util.Map;

@RestController
@RequestMapping("/auth")
public class AuthController {

    @Autowired
    private JwtMockService jwtMockService;

    @PostMapping("/mock-token")
    public Map<String, Object> generateMockToken(@RequestBody TokenRequest request) {
        String username = (request.input_token_state != null) ? request.input_token_state.username : "GB-SVC-UKBEREV";
        String token = jwtMockService.generateMockToken(username);

        Map<String, Object> outputState = new HashMap<>();
        outputState.put("token_type", "JWT");
        outputState.put("issued_token1", token);

        Map<String, Object> response = new HashMap<>();
        response.put("input_token_state", request.input_token_state);
        response.put("output_token_state", outputState);

        return response;
    }
}
